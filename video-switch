#!/bin/bash
#
# Cycle through video output modes:
#
# 1. Internal display only
# 2. Intenral / External Display (spanned)
# 3. External display only

INTERNAL_DISPLAY='LVDS'
EXTERNAL_DISPLAY='VGA-0'
DISPLAY_STATUS=`xrandr --query`

killall "cairo-compmgr"

if [[ $DISPLAY_STATUS == *$INTERNAL_DISPLAY\ connected\ \(* ]]
# KNOWN STATE:
# 	INTERNAL DISPLAY: INACTIVE (OFF)
# POSSIBLE STATES:
# 	EXTERNAL DISPLAY: CONNECTED/ACTIVE
#			  OR PREVIOUSLY CONNECTED/ACTIVE, RECENTLY DISCONNECTED
# ACTION:
#	TURN OFF EXTERNAL DISPLAY, TURN ON INTERNAL
then
	xrandr --output $INTERNAL_DISPLAY --auto --output $EXTERNAL_DISPLAY --off
else
# KNOWN STATE:
#	INTERNAL DISPLAY: ACTIVE
# POSSIBLE STATES:
#	EXTERNAL DISPLAY: CONNECTED/ACTIVE (SPANNED MODE)
#	EXTERNAL DISPLAY: CONNECTED/INACTIVE
#	EXTERNAL DISPLAY: DISCONNECTED
if [[ $DISPLAY_STATUS == *$EXTERNAL_DISPLAY\ connected\ \(* ]]
# KNOWN STATE:
#	INTERNAL DISPLAY: ACTIVE
#	EXTERNAL DISPLAY: CONNECTED/INACTIVE
# ACTION:
#	KEEP INTERNAL DISPLAY ON AND ACTIVATE EXTERNAL DISPLAY (SPANNED MODE)
then
	xrandr --output $INTERNAL_DISPLAY --auto --output $EXTERNAL_DISPLAY --auto --right-of $INTERNAL_DISPLAY
else
# KNOWN STATE:
#	INTERNAL DISPLAY: ACTIVE
# POSSIBLE STATES:
#	EXTERNAL DISPLAY: CONNECTED/ACTIVE (SPANNED MODE)
#	EXTERNAL DISPLAY: DISCONNECTED
if [[ $DISPLAY_STATUS == *$EXTERNAL_DISPLAY\ connected* ]]
# KNOWN STATE:
# 	INTERNAL DISPLAY: ACTIVE
#	EXTERNAL DISPLAY: CONNECTED/ACTIVE (SPANNED MODE)
# ACTION:
#	TURN OFF INTERNAL DISPLAY, SWITCH TO CURRENTLY ACTIVE EXTERNAL DISPLAY
then
	xrandr --output $INTERNAL_DISPLAY --off --output $EXTERNAL_DISPLAY --auto
else
# KNOWN STATE:
#	INTERNAL DISPLAY: ACTIVE
#	EXTERNAL DISPLAY: DISCONNECTED
# ACTION:
#	RESET DISPLAY STATE TO INTERNAL ONLY, JUST TO BE SAFE
	xrandr --output $INTERNAL_DISPLAY --auto --output $EXTERNAL_DISPLAY --off
fi
fi
fi

cairo-compmgr
